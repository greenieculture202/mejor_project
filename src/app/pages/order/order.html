<div class="order-container">
    <!-- STEP 1: CHECKOUT FORM -->
    <div class="order-card checkout-step" *ngIf="step === 'checkout'">
        <header class="order-header compact">
            <p class="subtitle">Complete your purchase in style</p>
            <div class="header-summary">
                <div class="id-group">
                    <span class="label">Order ID</span>
                    <span class="value">{{ orderId }}</span>
                </div>
                <div class="amount-group">
                    <span class="label">Total Amount</span>
                    <span class="value">‚Çπ{{ total | number }}</span>
                </div>
            </div>
        </header>

        <form class="checkout-form" (ngSubmit)="confirmOrder()">
            <!-- Personal Details -->
            <section class="form-section">
                <h3>üë§ Personal Details</h3>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" [(ngModel)]="formData.fullName" name="fullName"
                        placeholder="Enter your full name" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="tel" [(ngModel)]="formData.phone" name="phone" placeholder="9876543210" required>
                    </div>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" [(ngModel)]="formData.email" name="email" placeholder="you@example.com"
                            required>
                    </div>
                </div>
            </section>

            <!-- Shipping -->
            <section class="form-section">
                <h3>üöö Shipping Address</h3>
                <div class="form-group">
                    <textarea [(ngModel)]="formData.address" name="address" rows="3"
                        placeholder="Enter your full delivery address..." required></textarea>
                </div>
            </section>

            <!-- Payment -->
            <section class="form-section">
                <h3>üí≥ Payment Method</h3>
                <div class="payment-options">
                    <label class="payment-option" [class.selected]="formData.paymentMethod === 'online'">
                        <input type="radio" [(ngModel)]="formData.paymentMethod" name="paymentMethod" value="online">
                        <span class="icon">üîí</span>
                        <span class="text">Pay Online</span>
                    </label>
                    <label class="payment-option" [class.selected]="formData.paymentMethod === 'cod'">
                        <input type="radio" [(ngModel)]="formData.paymentMethod" name="paymentMethod" value="cod">
                        <span class="icon">üíµ</span>
                        <span class="text">Cash on Delivery</span>
                    </label>
                </div>

                <!-- Bank Details (Only if Online) -->
                <!-- Bank Details (Only if Online) -->
                <div class="bank-details" *ngIf="formData.paymentMethod === 'online'">
                    <h4>Enter Your Bank Details for Payment Verification:</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bank Name</label>
                            <input type="text" [(ngModel)]="formData.bankName" name="bankName"
                                placeholder="e.g. HDFC, SBI" required>
                        </div>
                        <div class="form-group">
                            <label>IFSC Code</label>
                            <input type="text" [(ngModel)]="formData.ifscCode" name="ifscCode" placeholder="ABCD0123456"
                                required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Account Number</label>
                        <input type="text" [(ngModel)]="formData.accountNumber" name="accountNumber"
                            placeholder="Enter your account number" required>
                    </div>

                    <div class="form-group">
                        <label>Account Holder Name</label>
                        <input type="text" [(ngModel)]="formData.senderName" name="senderName"
                            placeholder="Name as per bank records" required>
                    </div>

                    <div class="form-group">
                        <label>Transaction ID / UPI Reference</label>
                        <input type="text" [(ngModel)]="formData.transactionId" name="transactionId"
                            placeholder="Transaction Reference No." required>
                    </div>
                </div>
            </section>

            <div class="actions">
                <button type="button" class="cancel-btn" routerLink="/cart">Cancel</button>
                <button type="submit" class="confirm-btn">Confirm Order</button>
            </div>
        </form>
    </div>

    <!-- STEP 2: SUCCESS INVOICE -->
    <div class="order-card success-step" *ngIf="step === 'success'">
        <header class="order-header success">
            <h1>Order Confirmed!</h1>
            <p>Thank you just for being you.</p>
            <div class="success-icon">‚úÖ</div>
        </header>

        <div class="invoice-details">
            <div class="invoice-row">
                <span>Order ID:</span> <strong>{{ orderId }}</strong>
            </div>
            <div class="invoice-row">
                <span>Date:</span> <strong>{{ orderDate | date:'medium' }}</strong>
            </div>
            <div class="invoice-row">
                <span>Payment:</span> <strong>{{ formData.paymentMethod === 'online' ? 'Online Transfer' : 'Cash on
                    Delivery' }}</strong>
            </div>
            <div class="invoice-row">
                <span>Shipping to:</span> <strong>{{ formData.fullName }}, {{ formData.address }}</strong>
            </div>
        </div>

        <div class="order-items">
            <h3>Items Ordered</h3>
            <div class="item-list">
                <div *ngFor="let item of items" class="order-item">
                    <span class="item-name">{{ item.product.name }} (x{{ item.qty }})</span>
                    <span class="item-price">‚Çπ{{ item.total }}</span>
                </div>
            </div>
            <div class="order-summary">
                <div class="summary-row total">
                    <span>Total Amount</span>
                    <span>‚Çπ{{ total }}</span>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="print-btn" (click)="printInvoice()">Print Invoice üñ®Ô∏è</button>
            <button class="home-btn" routerLink="/">Continue Shopping</button>
        </div>

        <!-- REVIEW SECTION -->
        <div class="review-section">
            <div *ngIf="!reviewSubmitted; else reviewThanks">
                <h3>Rate Your Experience</h3>
                <p class="review-subtitle">Tell us what you think! Your review will help others.</p>

                <div class="star-rating">
                    <span *ngFor="let star of [1,2,3,4,5]" (click)="setRating(star)"
                        [class.filled]="star <= reviewRating">‚òÖ</span>
                </div>

                <textarea [(ngModel)]="reviewComment" placeholder="Write your review here..." rows="3"></textarea>

                <button class="submit-review-btn" (click)="submitReview()">Submit Review</button>
            </div>

            <ng-template #reviewThanks>
                <div class="review-thanks">
                    <h3>Thank You!</h3>
                    <p>Your review has been submitted successfully.</p>
                </div>
            </ng-template>
        </div>
    </div>
</div>